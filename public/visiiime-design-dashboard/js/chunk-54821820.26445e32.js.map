{"version":3,"sources":["webpack:///./src/components/design/linkItemList/linkDashboard/LinkDashboardChart.vue?0989","webpack:///./node_modules/core-js/modules/es.array.find-index.js","webpack:///./src/components/design/linkItemList/linkDashboard/LinkDashboardChart.vue?9999","webpack:///src/components/design/linkItemList/linkDashboard/LinkDashboardChart.vue","webpack:///./src/components/design/linkItemList/linkDashboard/LinkDashboardChart.vue?59fb","webpack:///./src/components/design/linkItemList/linkDashboard/LinkDashboardChart.vue?2747"],"names":["$","$findIndex","findIndex","addToUnscopables","FIND_INDEX","SKIPS_HOLES","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","anaData","startAt","endAt","_e","on","$event","$modal","show","linkItem","class","currentChart","changeChart","key","componentKey","staticRenderFns","component"],"mappings":"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","file":"js/chunk-54821820.26445e32.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkDashboardChart.vue?vue&type=style&index=0&lang=scss&\"","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mb-3\"},[_c('div',{staticClass:\"text-center bg-gray-500 text-white py-1\"},[_vm._v(\"連結分析\")]),(_vm.hasPermission)?_c('div',{staticClass:\"p-5\"},[(_vm.loaded)?_c('LineChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}}):_vm._e(),_c('div',{staticClass:\"p-5 pt-5 pb-0 text-center\"},[_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){return _vm.$modal.show((\"linkItemChartModal\" + (_vm.linkItem.id)))}}},[_vm._v(\"查看更多\")])])],1):_c('div',{staticClass:\"p-5\"},[_c('normal-alert')],1),_c('modal',{attrs:{\"name\":(\"linkItemChartModal\" + (_vm.linkItem.id)),\"max-width\":600,\"width\":\"90%\",\"height\":\"auto\",\"adaptive\":true}},[_c('div',{staticClass:\"card shadow-md bg-white py-3 px-4\"},[_c('div',{staticClass:\"tabs tabs-boxed justify-center\"},[_c('span',{staticClass:\"tab\",class:{'tab-active': _vm.currentChart === 'country'},on:{\"click\":function($event){return _vm.changeChart('country')}}},[_vm._v(\"國家\")]),_c('span',{staticClass:\"tab\",class:{'tab-active': _vm.currentChart === 'browser'},on:{\"click\":function($event){return _vm.changeChart('browser')}}},[_vm._v(\"瀏覽器\")]),_c('span',{staticClass:\"tab\",class:{'tab-active': _vm.currentChart === 'system'},on:{\"click\":function($event){return _vm.changeChart('system')}}},[_vm._v(\"系統\")]),_c('span',{staticClass:\"tab\",class:{'tab-active': _vm.currentChart === 'lang'},on:{\"click\":function($event){return _vm.changeChart('lang')}}},[_vm._v(\"語系\")]),_c('span',{staticClass:\"tab\",class:{'tab-active': _vm.currentChart === 'device'},on:{\"click\":function($event){return _vm.changeChart('device')}}},[_vm._v(\"裝置\")])]),_c('div',{staticClass:\"mb-2\"}),_c('div'),_c('div',{key:_vm.componentKey},[(_vm.currentChart === 'country')?_c('div',[_c('PieChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"title\":'國家',\"data-name\":'country',\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}})],1):_vm._e(),(_vm.currentChart === 'browser')?_c('div',[_c('PieChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"title\":'瀏覽器',\"data-name\":'browser',\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}})],1):_vm._e(),(_vm.currentChart === 'system')?_c('div',[_c('PieChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"title\":'系統',\"data-name\":'system',\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}})],1):_vm._e(),(_vm.currentChart === 'lang')?_c('div',[_c('PieChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"title\":'語系',\"data-name\":'lang',\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}})],1):_vm._e(),(_vm.currentChart === 'device')?_c('div',[_c('PieChart',{staticClass:\"flex-1 min-w-0\",attrs:{\"ana-data\":_vm.anaData,\"title\":'裝置',\"data-name\":'device',\"start-at\":_vm.startAt,\"end-at\":_vm.endAt}})],1):_vm._e()])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"mb-3\">\n        <div class=\"text-center bg-gray-500 text-white py-1\">連結分析</div>\n        <div v-if=\"hasPermission\" class=\"p-5\">\n            <LineChart v-if=\"loaded\" :ana-data=\"anaData\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n            <div class=\"p-5 pt-5 pb-0 text-center\">\n                <button \n                    @click=\"$modal.show(`linkItemChartModal${linkItem.id}`)\"\n                    class=\"btn btn-primary\"\n                >查看更多</button>\n            </div>\n        </div>\n        <div v-else class=\"p-5\">\n            <normal-alert></normal-alert>\n        </div>\n\n        <modal\n            :name=\"`linkItemChartModal${linkItem.id}`\"\n            :max-width=\"600\"\n            width=\"90%\"\n            height=\"auto\"\n            :adaptive=\"true\"\n        >\n            <div class=\"card shadow-md bg-white py-3 px-4\">\n                <div class=\"tabs tabs-boxed justify-center\">\n                    <span @click=\"changeChart('country')\" :class=\"{'tab-active': currentChart === 'country'}\" class=\"tab\">國家</span> \n                    <span @click=\"changeChart('browser')\" :class=\"{'tab-active': currentChart === 'browser'}\" class=\"tab\">瀏覽器</span> \n                    <span @click=\"changeChart('system')\" :class=\"{'tab-active': currentChart === 'system'}\" class=\"tab\">系統</span>\n                    <span @click=\"changeChart('lang')\" :class=\"{'tab-active': currentChart === 'lang'}\" class=\"tab\">語系</span>\n                    <span @click=\"changeChart('device')\" :class=\"{'tab-active': currentChart === 'device'}\" class=\"tab\">裝置</span>\n                </div>\n                <div class=\"mb-2\">\n                </div>\n                <div>\n                </div>\n                <div :key=\"componentKey\">\n                    <div v-if=\"currentChart === 'country'\">\n                        <PieChart :ana-data=\"anaData\" :title=\"'國家'\" :data-name=\"'country'\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n                        \n                    </div>\n                    <div v-if=\"currentChart === 'browser'\">\n                        <PieChart :ana-data=\"anaData\" :title=\"'瀏覽器'\" :data-name=\"'browser'\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n                        \n                    </div>\n                    <div v-if=\"currentChart === 'system'\">\n                        <PieChart :ana-data=\"anaData\" :title=\"'系統'\" :data-name=\"'system'\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n                        \n                    </div>\n                    <div v-if=\"currentChart === 'lang'\">\n                        <PieChart :ana-data=\"anaData\" :title=\"'語系'\" :data-name=\"'lang'\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n                        \n                    </div>\n                    <div v-if=\"currentChart === 'device'\">\n                        <PieChart :ana-data=\"anaData\" :title=\"'裝置'\" :data-name=\"'device'\" :start-at=\"startAt\" :end-at=\"endAt\" class=\"flex-1 min-w-0\" />\n                        \n                    </div>\n                </div>\n            </div>\n        </modal>\n    </div>\n</template>\n<script>\nimport LineChart from \"@/components/widgets/analysis/lineChart/LineChartMain\";\nimport PieChart from \"@/components/widgets/analysis/pieChart/PieChartMain\";\nimport moment from \"moment\";\nimport trackApi from \"@/api/track/TrackApi\";\nimport LinkItemVO from \"@/vo/design/linkItemList/LinkItemVO\";\nimport NormalAlert from \"@/components/widgets/permission/NormalAlert\";\nimport { linkEvent } from \"@/enum/vo/LinkItemEnum\";\nimport { CAN_USE_LINK_ITEM_DBOARD_CHART } from \"@/enum/permission/vBasic/VPermission\";\n\nexport default {\n    components: {\n        LineChart,\n        PieChart,\n        NormalAlert\n    },\n    data() {\n        return {\n            anaData: [],\n            currentChart: 'country',\n            loaded: false,\n            componentKey: 0\n        };\n    },\n    props: {\n        idx: {\n            type: Number,\n            required: true,\n        },\n        linkItem: {\n            type: LinkItemVO,\n            required: true,\n        },\n    },\n    computed: {\n        hasPermission() {\n            return this.$store.getters.hasPermission(CAN_USE_LINK_ITEM_DBOARD_CHART);\n        },\n        startAt() {\n            let startAt = moment().subtract(6, \"days\").format(\"YYYY-MM-DD\");\n            return startAt;  \n        },\n        endAt() {\n            let now = moment().format('YYYY-MM-DD');\n            return now;\n        }\n    },\n    methods: {\n        setData(item, field, list) {\n            let findIdx = this[list].findIndex(el => el[field] === item[field]);\n            if(findIdx === -1) {\n                this[list].push({\n                    [field]: item[field],\n                    count: 1,\n                });\n            } else {\n                this[list][findIdx].count ++;\n            }\n        },\n        sortList(list) {\n            const sorted = this[list].slice().sort((firstEl, secondEl) => {\n                if(firstEl.count < secondEl.count) return 1;\n                if(firstEl.count > secondEl.count) return -1;\n                return 0;\n            });\n            return sorted;\n        },\n        async changeChart(type) {\n            this.currentChart = type\n\n            await this.updateComponent()\n        },\n        async updateComponent() {\n            this.componentKey += 1;\n        },\n        async getData() {\n            if(!this.hasPermission) {\n                return [];\n            }\n            let { data } = await trackApi.getEventData({\n                model_id: this.linkItem.id,\n                start_at: this.startAt,\n                end_at: this.endAt,\n                event_type: linkEvent.click,\n                is_parent: false\n            });\n\n            return data;\n        },\n    },\n    async mounted() {\n\n        this.anaData = await this.getData();\n\n        this.loaded = true;\n    },\n};\n</script>\n\n<style lang=\"scss\">\n.small {\n    max-width: 600px;\n    margin:  150px auto;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkDashboardChart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinkDashboardChart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LinkDashboardChart.vue?vue&type=template&id=8fef41cc&\"\nimport script from \"./LinkDashboardChart.vue?vue&type=script&lang=js&\"\nexport * from \"./LinkDashboardChart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LinkDashboardChart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}