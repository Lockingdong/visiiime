(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54821820"],{"3a82":function(t,a,e){"use strict";e("6138")},6138:function(t,a,e){},c740:function(t,a,e){"use strict";var n=e("23e7"),s=e("b727").findIndex,r=e("44d2"),i="findIndex",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r(i)},f7bc:function(t,a,e){"use strict";e.r(a);var n,s,r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mb-3"},[e("div",{staticClass:"text-center bg-gray-500 text-white py-1"},[t._v("連結分析")]),t.hasPermission?e("div",{staticClass:"p-5"},[t.loaded?e("LineChart",{attrs:{chartdata:t.lineChartData,options:t.options,height:200}}):t._e(),e("div",{staticClass:"p-5 pt-0 text-center"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.$modal.show("linkItemChartModal"+t.linkItem.id)}}},[t._v("查看更多")])])],1):e("div",{staticClass:"p-5"},[t._v(" You don't have the permission. ")]),e("modal",{attrs:{name:"linkItemChartModal"+t.linkItem.id,"max-width":600,width:"90%",height:"auto",adaptive:!0}},[e("v-card",[e("div",{staticClass:"mb-2"},[e("v-tag",{staticClass:"text-lg py-2 cursor-pointer mr-1",attrs:{"tag-name":"h1",variant:"badge"},nativeOn:{click:function(a){return t.changeChart("country")}}},[t._v("國家")]),e("v-tag",{staticClass:"text-lg py-2 cursor-pointer mr-1",attrs:{"tag-name":"h1",variant:"badge"},nativeOn:{click:function(a){return t.changeChart("browser")}}},[t._v("瀏覽器")]),e("v-tag",{staticClass:"text-lg py-2 cursor-pointer mr-1",attrs:{"tag-name":"h1",variant:"badge"},nativeOn:{click:function(a){return t.changeChart("system")}}},[t._v("系統")]),e("v-tag",{staticClass:"text-lg py-2 cursor-pointer",attrs:{"tag-name":"h1",variant:"badge"},nativeOn:{click:function(a){return t.changeChart("lang")}}},[t._v("語系")])],1),e("div"),"country"===t.currentChart?e("div",t._l(t.sortedCountries,(function(a,n){return e("v-card",{key:n},[e("div",{staticClass:"flex items-center justify-between"},[e("div",[t._v(t._s(a.iso_code))]),e("v-tag",{attrs:{"tag-name":"span",variant:"badge"}},[t._v(t._s(a.count))])],1)])})),1):t._e(),"browser"===t.currentChart?e("div",t._l(t.sortedBrowsers,(function(a,n){return e("v-card",{key:n},[e("div",{staticClass:"flex items-center justify-between"},[e("div",[t._v(t._s(a.browser))]),e("v-tag",{attrs:{"tag-name":"span",variant:"badge"}},[t._v(t._s(a.count))])],1)])})),1):t._e(),"system"===t.currentChart?e("div",t._l(t.sortedSystems,(function(a,n){return e("v-card",{key:n},[e("div",{staticClass:"flex items-center justify-between"},[e("div",[t._v(t._s(a.system))]),e("v-tag",{attrs:{"tag-name":"span",variant:"badge"}},[t._v(t._s(a.count))])],1)])})),1):t._e(),"lang"===t.currentChart?e("div",t._l(t.sortedLangs,(function(a,n){return e("v-card",{key:n},[e("div",{staticClass:"flex items-center justify-between"},[e("div",[t._v(t._s(a.lang))]),e("v-tag",{attrs:{"tag-name":"span",variant:"badge"}},[t._v(t._s(a.count))])],1)])})),1):t._e()])],1)],1)},i=[],o=e("ade3"),c=(e("a9e3"),e("c740"),e("fb6a"),e("159b"),e("b64b"),e("ac1f"),e("1276"),e("99af"),e("caad"),e("1fca")),u={extends:c["a"],props:["chartdata","options"],mounted:function(){this.renderChart(this.chartdata,this.options)}},d=u,l=e("2877"),h=Object(l["a"])(d,n,s,!1,null,null,null),v=h.exports,g=e("16aa"),f=e("881a"),p=e("4409"),b={components:{LineChart:v},data:function(){return{datacollection:null,loaded:!1,lineChartData:{labels:[],datasets:[{label:"總點擊",fill:!1,backgroundColor:"#8eb9dd",data:[],borderColor:"#8eb9dd"},{label:"獨立點擊",fill:!1,backgroundColor:"#13b881",data:[],borderColor:"#13b881"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"次數"},ticks:{suggestedMax:5,stepSize:1,min:0}}]}},currentChart:"country",countries:[],browsers:[],systems:[],langs:[]}},props:{idx:{type:Number,required:!0},linkItem:{type:f["a"],required:!0}},computed:{hasPermission:function(){return this.$store.getters.hasPermission(p["b"])},sortedCountries:function(){return this.sortList("countries")},sortedBrowsers:function(){return this.sortList("browsers")},sortedSystems:function(){return this.sortList("systems")},sortedLangs:function(){return this.sortList("langs")}},methods:{setData:function(t,a,e){var n,s=this[e].findIndex((function(e){return e[a]===t[a]}));-1===s?this[e].push((n={},Object(o["a"])(n,a,t[a]),Object(o["a"])(n,"count",1),n)):this[e][s].count++},sortList:function(t){var a=this[t].slice().sort((function(t,a){return t.count<a.count?1:t.count>a.count?-1:0}));return a},changeChart:function(t){this.currentChart=t}},mounted:function(){var t=this;g["a"].getWeekData({model_id:this.linkItem.id}).then((function(a){t.loaded=!0;var e=a.data;Object.keys(e).forEach((function(a){var n=a.split("-");t.lineChartData.labels.push("".concat(n[1],"/").concat(n[2]));var s=[],r=[];e[a].forEach((function(a){s.push(a.ip),t.setData(a,"iso_code","countries"),t.setData(a,"browser","browsers"),t.setData(a,"system","systems"),t.setData(a,"lang","langs"),r.includes(a.ip)||r.push(a.ip)})),t.lineChartData.datasets[0].data.push(s.length),t.lineChartData.datasets[1].data.push(r.length)}))})).catch((function(t){console.log(t)}))}},m=b,C=(e("3a82"),Object(l["a"])(m,r,i,!1,null,null,null));a["default"]=C.exports}}]);
//# sourceMappingURL=chunk-54821820.e73ec15a.js.map